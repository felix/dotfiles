set smime_is_default    = yes
#set smime_ca_location   = '/usr/local/share/certs/ca-root-nss.crt'
set smime_ca_location   = '/usr/share/ca-certificates/mozilla/Entrust_Root_Certification_Authority.crt'
set smime_certificates  = "~/.smime/certificates"
set smime_keys          = "~/.smime/keys"
set crypt_replysign     = yes
set crypt_replyencrypt  = yes
set crypt_replysignencrypted = yes
set crypt_verify_sig    = yes

# First generate a PKCS#7 structure from the message.
set smime_pk7out_command="openssl smime -verify -in %f -noverify -pk7out"
# Extract the included certificate(s) from a PKCS#7 structure.
set smime_get_cert_command="openssl pkcs7 -print_certs -in %f"
# Extract the signer's certificate only from a S/MIME signature (sender verification)
set smime_get_signer_cert_command="openssl smime -verify -in %f -noverify -signer %c -out /dev/null"
# This is used to get the email address the certificate was issued to.
set smime_get_cert_email_command="openssl x509 -in %f -noout -email"
# Add a certificate to the database using smime_keys.
#set smime_import_cert_command="/usr/local/libexec/neomutt/smime_keys add_cert %f"
set smime_import_cert_command="/usr/lib/neomutt/smime_keys add_cert %f"
# Algorithm to use for encryption.
# valid choices are aes128, aes192, aes256, rc2-40, rc2-64, rc2-128, des, des3
set smime_encrypt_with="aes256"
# Encrypt a message.  Input file is a MIME entity.
set smime_encrypt_command="openssl smime -encrypt -%a -outform DER -in %f %c"
# Algorithm for the signature message digest.
# Valid choices are md5, sha1, sha224, sha256, sha384, sha512.
set smime_sign_digest_alg="sha256"
# Sign.
set smime_sign_command="openssl smime -sign -md %d -signer %c -inkey %k -passin stdin -in %f -certfile %i -outform DER"
# Decrypt a message.  Output is a MIME entity.
set smime_decrypt_command="openssl smime -decrypt -passin stdin -inform DER -in %f -inkey %k -recip %c"
# Verify a signature of type multipart/signed
set smime_verify_command="openssl smime -verify -inform DER -in %s %C -content %f"
# Verify a signature of type application/x-pkcs7-mime
set smime_verify_opaque_command="\
openssl smime -verify -inform DER -in %s %C || \
openssl smime -verify -inform DER -in %s -noverify 2>/dev/null"

# vim: set ft=muttrc :
